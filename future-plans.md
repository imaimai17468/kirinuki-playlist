# Kirinuki-Playlist 今後の開発計画

このドキュメントは、Kirinuki-Playlist プロジェクトの今後の開発方針と実装予定の機能をまとめたものです。優先度順に実装していきます。

## 1. 認証機能（Clerk 連携）

- [x] **Clerk の基本設定**

  - [x] Clerk アカウント作成と設定
  - [x] 環境変数の設定
  - [x] Next.js への Clerk SDK インストール

- [x] **認証関連コンポーネント**

  - [x] SignIn ボタン/コンポーネント
  - [x] UserButton コンポーネント
  - [x] ユーザープロフィール表示

- [x] **保護されたルートの設定**

  - [x] ミドルウェアの実装方針決定
  - [x] 未認証ユーザーのリダイレクト設定の実装

- [x] **ユーザー同期**
  - [x] Clerk ウェブフック設定
  - [x] ユーザー作成時の DB との同期機能（優先実装）
  - [ ] ユーザー更新/削除時の DB との同期機能（次フェーズで実装）

## 2. ユーザーフォロー機能

- [ ] **データモデル実装**

  - [ ] follows テーブルの作成
  - [ ] authors テーブルとのリレーション設定

- [ ] **バックエンド実装**

  - [ ] フォローサービスの実装
    - [ ] フォロー/アンフォロー機能
    - [ ] フォロワー/フォロー中リスト取得
  - [ ] API エンドポイントの実装
    - [ ] `/api/users/[id]/follow`（POST/DELETE）
    - [ ] `/api/users/[id]/followers`（GET）
    - [ ] `/api/users/[id]/following`（GET）

- [ ] **フロントエンド実装**
  - [ ] フォローボタンコンポーネント
  - [ ] フォロワー/フォロー中一覧ページ
  - [ ] ユーザー詳細ページへの統合

## 3. 自分の動画ページ

- [ ] **マイページ実装**

  - [ ] マイ動画一覧ページ
  - [ ] 動画管理機能（編集/削除）

- [ ] **バックエンド実装**

  - [ ] ユーザー所有動画取得 API
  - [ ] 動画アップロード/更新/削除 API

- [ ] **フロントエンド実装**
  - [ ] 動画アップロードフォーム
  - [ ] 動画編集フォーム
  - [ ] マイ動画一覧表示

## 4. いいね機能（動画）

- [ ] **データモデル実装**

  - [ ] likes テーブルの作成（polymorphic 関連）
  - [ ] videos テーブルとのリレーション設定

- [ ] **バックエンド実装**

  - [ ] いいねサービスの実装
    - [ ] いいね追加/削除機能
    - [ ] いいね数取得機能
  - [ ] API エンドポイントの実装
    - [ ] `/api/videos/[id]/like`（POST/DELETE）
    - [ ] `/api/users/me/likes/videos`（GET）

- [ ] **フロントエンド実装**
  - [ ] いいねボタンコンポーネント
  - [ ] 動画詳細ページへの統合
  - [ ] いいねした動画一覧ページ

## 5. いいね機能（プレイリスト）

- [ ] **バックエンド実装**

  - [ ] いいねサービスの拡張（プレイリスト対応）
  - [ ] API エンドポイントの実装
    - [ ] `/api/playlists/[id]/like`（POST/DELETE）
    - [ ] `/api/users/me/likes/playlists`（GET）

- [ ] **フロントエンド実装**
  - [ ] プレイリスト用いいねボタン
  - [ ] プレイリスト詳細ページへの統合
  - [ ] いいねしたプレイリスト一覧ページ

## 6. 通知機能

- [ ] **データモデル実装**

  - [ ] notifications テーブルの作成
  - [ ] 通知タイプ（フォロー、いいね等）の設計

- [ ] **バックエンド実装**

  - [ ] 通知サービスの実装
    - [ ] 通知作成/既読設定機能
    - [ ] 通知一覧取得機能
  - [ ] 通知トリガーの実装
    - [ ] フォロー時の通知
    - [ ] いいね時の通知
  - [ ] API エンドポイントの実装
    - [ ] `/api/notifications`（GET）
    - [ ] `/api/notifications/[id]/read`（POST）

- [ ] **フロントエンド実装**
  - [ ] 通知一覧コンポーネント
  - [ ] 通知バッジ（未読カウント表示）
  - [ ] 通知詳細ページ

## 7. アカウント設定画面

- [ ] **バックエンド実装**

  - [ ] ユーザー情報更新 API
  - [ ] アバター画像アップロード API

- [ ] **フロントエンド実装**
  - [ ] プロフィール編集フォーム
  - [ ] アバター画像アップロード機能
  - [ ] アカウント設定ページ

## 8. 課金機能

- [ ] **支払いゲートウェイ統合**

  - [ ] Stripe 連携設定
  - [ ] 商品・価格プラン設定

- [ ] **データモデル実装**

  - [ ] subscriptions テーブルの作成
  - [ ] 支払い履歴テーブルの作成

- [ ] **バックエンド実装**

  - [ ] 課金サービスの実装
    - [ ] サブスクリプション作成/更新/キャンセル
    - [ ] 支払い Webhook 処理
  - [ ] API エンドポイントの実装
    - [ ] `/api/subscriptions`（各種操作）
    - [ ] `/api/checkout-sessions`（決済フロー）

- [ ] **フロントエンド実装**
  - [ ] プラン選択ページ
  - [ ] 課金状況表示
  - [ ] 決済フロー UI
  - [ ] アップグレードプロモーション

## 技術負債対応項目

- [ ] **テストカバレッジ向上**

  - [ ] 単体テストの充実
  - [ ] E2E テストの導入

- [ ] **コードリファクタリング**

  - [ ] 共通コンポーネントの整理
  - [ ] 型定義の最適化

- [ ] **パフォーマンス最適化**

  - [ ] クエリ最適化
  - [ ] バンドルサイズ最適化
  - [ ] キャッシュ戦略の見直し

- [ ] **セキュリティ強化**
  - [ ] 脆弱性スキャン導入
  - [ ] 入力検証の強化
